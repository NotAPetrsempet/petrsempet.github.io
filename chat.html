<title>Спроси у мага</title>
<body style="background-color: lightgray;">
  <script src="https://api-maps.yandex.ru/2.0-stable/?load=package.standard&lang=ru-RU"type="text/javascript"></script>
  <div style="height: 90px; width: 470px; background-color: white; position: fixed; bottom: 0px; right: 220px; word-break: auto;" id="block"><input id="msg" style="word-break: auto; font-size: 14px; padding:10px; border-radius: 10px; width: 300px;" onkeydown="key(event)" placeholder="Введите сообщение..."><input type="submit" style="background-color: rgb(5, 205, 81); padding: 10px; width: 150px; height: 40px; border-radius: 10px; color:white; font-weight: bold;" onclick="send()" value="Отправить!"><br><p>Мы используем куки-файлы!</p></div>
<script>
  var cheat = false;
  function key(event){
    console.log(event)
    if (event.key == 'Enter'){
    send();
    }
  }
  var name = "";
  
  var check_name = true;
  var http = http = new XMLHttpRequest();
http.open('GET', 'https://jsonip.com', true);
  var ip ="человек";
  http.onreadystatechange = function(){
    if (this.status == 200 && this.readyState == 4){
  ip = JSON.parse(http.responseText).ip;
      if (document.cookie == ""){
  document.body.innerHTML += '<div style="background-color: white; border-radius: 10px; word-break: auto; width: 200px;"><p style="padding: 5px;">Привет, '+ip+'! Меня зовут Маг. А как тебя зовут?</p></div>';
      }else{
      
  document.body.innerHTML += '<div style="background-color: white; border-radius: 10px; word-break: auto; width: 200px;"><p style="padding: 5px;">Привет, '+decodeURI(document.cookie.substring(5))+'!</p></div>';
        check_name=false;
        name = decodeURI(document.cookie.substring(5));
    }
  }
  }
  http.send();
  var last = "";
  var hay = false;
  function send(){
    var cheats = false;
    var isName = false;
    if (msg.value == ''){return;}
    var txt = ['Да', 'Ага', 'Угу', 'Понятно'];
    var text = txt[Math.floor(Math.random()*txt.length)];
    if (check_name){
    if (msg.value.toLowerCase().indexOf('меня зовут') != -1){
    name = msg.value.substring(msg.value.toLowerCase().indexOf('меня зовут')+11);
      check_name = false;
      document.cookie = "name="+encodeURIComponent(name)+"; domain=petrsempet.github.io; secure";
      text = "Приятно познакомится, "+name+"! Ты можешь задавать мне абсолютно любые вопросы и я на них обязательно отвечу!";
      isName = true;
    }else{
      text = 'Всё таки, напиши, пожалуйста, своё имя в формате "Меня зовут (имя)"';
    
    }
    }else{
    if (last == msg.value){
        text = "Давай другое уже!";
    }else if(hay){
      text = "А у меня всё отлично!!! В городе тоже";
      hay = false;
    }else if (msg.value.toLowerCase().indexOf('когда') != -1){
      var texts = ["Сегодня","Завтра", "Не знаю","Скоро, готовься!","В "+Math.floor(Math.random()*(23-0+1))+" ч. "+Math.floor(Math.random()*(59-0+1))+" мин.","Через "+Math.floor(Math.random()*(23-0+1))+" ч. "+Math.floor(Math.random()*(59-0+1))+" мин.", "В следующем году", "На следующей неделе", "В этом месяце"];
      text = texts[Math.floor(Math.random()*texts.length)];
    }else if (msg.value.toLowerCase().indexOf('какой') != -1){
      var texts = ["Красивый","Отличный", "Хороший","Добрый","Красный","Голубой", "Жёлтый", "Чёткий", "Прекрасный"];
      text = texts[Math.floor(Math.random()*texts.length)];
    }else if (msg.value.toLowerCase().indexOf('кто я') != -1){
      text = '<img width="180" height="154" src="https://memepedia.ru/wp-content/uploads/2020/01/hto-ja.png">';
    }else if (msg.value.toLowerCase().indexOf('какая') != -1){
      var texts = ["Красивая","Отличная", "Хорошая","Добрая","Красная","Голубая", "Жёлтая", "Чёткая", "Прекрасная"];
      text = texts[Math.floor(Math.random()*texts.length)];
    }else if (msg.value.toLowerCase().indexOf('какое') != -1){
      var texts = ["Красивое","Отличное", "Хорошое","Доброе","Красное","Голубое", "Жёлтое", "Чёткое", "Прекрасное", "Полезное"];
      text = texts[Math.floor(Math.random()*texts.length)];
    }else if (msg.value.toLowerCase().indexOf('как дела') != -1){
      var texts = ["Нормально","Отлично", "Не плохо","Хорошо","Прекрасно","Не очень", "Плохо", "В натуре", "Класс"];
      text = texts[Math.floor(Math.random()*texts.length)];
    }else if (msg.value.toLowerCase() == 'правда?'){
      text = 'Конечно! Я всегда говорю только правду!';
    }else if (msg.value.toLowerCase() == 'о программе'){
      text = '© Семендилов П. С. 2020 г. Ответы, выданные данной программой получены случайным способ и не являются офертой. Программа написана на JavaScript и HTML.';
    }else if (msg.value.toLowerCase().indexOf('неправда') != -1 || msg.value.toLowerCase().indexOf('не правда') != -1){
      text = 'Ответы, выданные данной программой получены случайным способ и не являются офертой.';
    }else if (msg.value.toLowerCase().indexOf('как меня зовут') != -1){
      text = "Ты — "+name+", я — Маг Бумаг";
    }else if (msg.value.toLowerCase().indexOf('меня зовут') != -1){
    name = msg.value.substring(msg.value.toLowerCase().indexOf('меня зовут')+11);
      document.cookie = "name="+encodeURIComponent(name)+"; domain=petrsempet.github.io; secure";
      text = "Извини, "+name+"!";
      isName = true;
    }else if (msg.value.toLowerCase().indexOf('дарова') != -1 || msg.value.toLowerCase().indexOf('привет') != -1){
      text = 'Как дела? Как '+ymaps.geolocation.city+'?';
      hay = true;
    }else if (msg.value.toLowerCase().indexOf('как') != -1){
      var texts = ["А вот так!","Отлично", "Быстро","Долго","Квадратно","Чётко", "Красиво", "Со вкусом", "Нормально"];
      text = texts[Math.floor(Math.random()*texts.length)];
    }else if (msg.value.toLowerCase().indexOf('кто') != -1){
      var texts = ["Я","Ты", "В. В. Путин","Босс","А. С. Пушкин","Друг", "Брат", "Кореш", "Знакомый", "Не знаю", name];
      text = texts[Math.floor(Math.random()*texts.length)];
      isName = true;
    }else if (msg.value.toLowerCase().indexOf('что') != -1){
      var texts = ["Взрыв","Пожар", "Ничего","Не знаю","Дом","Животное", "Иди домой", "Ничего", "Не знаю", "Да"];
      text = texts[Math.floor(Math.random()*texts.length)];
    }else if (msg.value.toLowerCase().indexOf('где') != -1){
      var texts = ["Не знаю","Там", "Здесь","В школе","На работе","Дома", "В парке", "За компом", "В телефоне"];
      text = texts[Math.floor(Math.random()*texts.length)];
    }else if (msg.value.toLowerCase().indexOf('почему') != -1){
      var texts = ["Потому","По качану", "Из-за взрыва","Из-за законов","Из-за возраста","Из-за интернета", "Не скажу", "Из-за карантина", "Из-зи коронавируса"];
      text = texts[Math.floor(Math.random()*texts.length)];
    }else if (msg.value.toLowerCase().indexOf('зачем') != -1){
      var texts = ["Просто так","Чтобы повечилиться", "Для помощи","Не знаю","Чтобы попить и поесть","Для удовольствия", "Не знаю"];
      text = texts[Math.floor(Math.random()*texts.length)];
    }else if (msg.value.toLowerCase().indexOf('в чём смысл жизни') != -1){
      text = 'Общаться со мной и искать смысл жизни)))';
    }else if (msg.value.toLowerCase().indexOf('сколько') != -1){
      text = Math.floor(Math.random()*1001);
    }else if (msg.value.toLowerCase().indexOf(')') != -1){
      text = ")))))";
    }else if (msg.value == "ЧИТЫ ВКЛ 548261264"){
      text = "Читы включены, Босс!";
      cheat = true;
    }else if (msg.value.indexOf('ПИШИ') == 0 & cheat){
      text = msg.value.substring(5);
      cheats = true;
    }else if (msg.value.toLowerCase().indexOf('?') != -1){
      var texts = ["Да","Не знаю", "Нет"];
      text = texts[Math.floor(Math.random()*texts.length)];
    }
    }
    if (!cheats){
  document.body.innerHTML += '<div style="margin-right: 0px; margin-left: auto; background-color: rgb(220, 248, 198); border-radius: 10px; word-break: auto; width: 200px;" ><p style="padding: 5px;">'+msg.value+'</p></div>';
    last = msg.value;
    msg.value = "";
  if (Math.floor(Math.random()*(100-0+1)) >95 & name != "" & !isName){
      text = name + ', '+text.toLowerCase();
      }    
    }
  document.body.innerHTML += '<div style="background-color: white; border-radius: 10px; word-break: auto; width: 200px;"><p style="padding:5px;">'+text+'</p></div>';
  
   }
  
  </script>
</body>
